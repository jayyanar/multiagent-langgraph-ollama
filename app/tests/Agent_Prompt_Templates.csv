Agent Name,Role / Purpose,Inputs,Outputs,Prompt Template
Ingestion Agent,Detects and collects invoice PDFs via API integration or manual upload to the system.,API endpoint / File Upload,Raw Invoice PDF File,No prompt needed. Handled via integration or UI upload mechanism.
Document Understanding Agent,"Parses the uploaded PDF and extracts structured metadata including Manufacturer, Distributor, and Dealer details.",Invoice PDF text (from OCR),"manufacturer, distributor, dealer","You are a document parsing assistant. Extract key metadata from the following invoice text:
OCR Text: {{ocr_text}}

Return JSON:
{
  ""manufacturer"": """",
  ""distributor"": """",
  ""dealer"": """"
}"
SPI Block Extractor,Extracts the Special Process Instruction (SPI) block either from API payload or uploaded input files.,Invoice content (JSON or text),SPI Block text,"Extract the Special Process Instruction (SPI) section from the following invoice content:
Invoice Text: {{invoice_text}}

Return only the SPI block."
SPI Lookup Agent,Performs semantic search against VectorDB (Elasticsearch) loaded with enriched SPI acronyms and contextual prompt data to find matching SPI patterns.,Extracted SPI code,Matched SPI interpretation (if found),"Search for semantic matches of this SPI code in the VectorDB:
SPI Code: {{spi_code}}

Return top 3 closest matches."
SPI Reasoning Agent,Uses Gemini Pro to interpret the meaning of the SPI code. Generates a plain-English explanation and dynamic prompt based on extracted context.,"SPI code, extracted roles, required fields","Split logic, routing, plain-English explanation","You are a compliance expert. Given the SPI code and parties involved, interpret and explain the instruction:
SPI Code: {{spi_code}}
Roles: Manufacturer - {{manufacturer}}, Dealer - {{dealer}}, Distributor - {{distributor}}

Also generate a dynamic plan in plain English describing what actions must be taken.

Return:
{
  ""split_logic"": """",
  ""routing_instructions"": """",
  ""plain_english_summary"": """"
}"
Extraction Agent,Consolidates insights from SPI Reasoning and Document Understanding Agents to extract required fields for downstream systems.,SPI interpretation + Metadata,Final extracted fields,"You are a data extractor. Based on the following information, extract the required fields for ERP update.
SPI Interpretation: {{spi_interpretation}}
Metadata: {{metadata}}

Return structured JSON output for:
{
  ""field1"": """",
  ""field2"": """",
  ...
}"
Response Agent,Formats and returns the final output as a structured JSON payload for downstream systems.,Final extracted fields,ERP-ready JSON payload,"Convert the following extracted data into a JSON format required by the downstream system:
Data: {{extracted_data}}

Return the payload as:
{
  ""erp_payload"": {...}
}"
